#
# This file is part of Python Client Library for WTSS.
# Copyright (C) 2020 INPE.
#
# Python Client Library for WTSS is free software; you can redistribute it and/or modify it
# under the terms of the MIT License; see LICENSE file for more details.
#

language: python

os: linux

cache:
    directories:
        - "$HOME/.cache/pip"

git:
    quiet: true
    submodules: false

branches:
    only:
        - master
        - b-0.7.0
        - b-0.8.0
        - b-1.0.0

dist: bionic

services:
    - docker

python:
    - 3.7

before_install:
    - pip install --upgrade pip
    - pip install --upgrade setuptools

install:
    - pip install -e .[tests,docs]

script:
    - ./run-tests.sh

after_success:
    - coveralls

deploy:
    provider: pypi
    username: $PYPI_USERNAME
    password: $PYPI_PASSWORD
    server: $PYPI_SERVER
    distributions: "sdist"
    edge: true
    skip_existing: true
    on:
        tags: true
